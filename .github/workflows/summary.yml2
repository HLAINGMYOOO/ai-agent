name: Summarize new issues

on:
  issues:
    types: [opened]

jobs:
  summary:
    runs-on: ubuntu-latest
    permissions:
      issues: write
      models: read
      contents: read

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Run AI inference
        id: inference
        uses: actions/ai-inference@v1
        with:
          prompt: |
            Summarize the following GitHub issue in one paragraph:
            Title: ${{ github.event.issue.title }}
            Body: ${{ github.event.issue.body }}

      - name: Comment with AI summary
        run: |
          gh issue comment $ISSUE_NUMBER --body '${{ steps.inference.outputs.response }}'
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          ISSUE_NUMBER: ${{ github.event.issue.number }}
          RESPONSE: ${{ steps.inference.outputs.response }}
                      - name: Montara CI
  # You may pin to the exact commit or the version.
  # uses: montara-io/montara-ci@eca5afc53f2e39c847d187e4bf43b1bef9e1056e
  uses: montara-io/montara-ci@v1.0.20
  with:
    # The URL of the webhook
    webhookUrl: 
    # Whether to use smart run, defaults to true
    isSmartRun: # optional, default is true
    # The variables to pass to the test run, a stringified JSON object of key-value pairs. for example: {"var1": "value1", "var2": "value2"}
    variables: # optional
    # Whether to allow concurrent pipeline runs, defaults to true
    allowConcurrentPipelineRuns: # optional, default is true
    # The number of retries to attempt
    numRetries: # optional, default is 60
                      - name: Nitpick AI
  # You may pin to the exact commit or the version.
  # uses: AlexanderTar/nitpick-ai-action@96c89ed8d8efc1093f07c9a99fcad9c10b3afe7d
  uses: AlexanderTar/nitpick-ai-action@v0.3.0
  with:
    # GitHub token for posting reviews
    github-token: 
    # AI model to use for the review. Accepted values are: claude-3.5-sonnet (recommended) and gpt-3.5
    ai-model: # default is claude-3.5-sonnet
    # API key for the AI model
    api-key: 
    # Whether to request changes or post review as a comment
    strict: # optional, default is false
    # Array of glob patterns for files to ignore
    ignore-patterns: # optional, default is []
                      - name: Run Gemini CLI
  # You may pin to the exact commit or the version.
  # uses: google-github-actions/run-gemini-cli@68d5a6d2e31ff01029205c58c6bf81cb3d72910b
  uses: google-github-actions/run-gemini-cli@v0.1.3
  with:
    # A string passed to the Gemini CLI's [`--prompt` argument](https://github.com/google-gemini/gemini-cli/blob/main/docs/cli/configuration.md#command-line-arguments).
    prompt: # optional, default is You are a helpful assistant.
    # A JSON string written to `.gemini/settings.json` to configure the CLI's _project_ settings.
For more details, see the documentation on [settings files](https://github.com/google-gemini/gemini-cli/blob/main/docs/cli/configuration.md#settings-files).
    settings: # optional
    # The API key for the Gemini API.
    gemini_api_key: # optional
    # The Google Cloud project ID.
    gcp_project_id: # optional
    # The Google Cloud location.
    gcp_location: # optional
    # The Google Cloud Workload Identity Provider.
    gcp_workload_identity_provider: # optional
    # The Google Cloud service account email.
    gcp_service_account: # optional
    # A flag to indicate if Vertex AI should be used.
    use_vertex_ai: # optional, default is false
    # A flag to indicate if Gemini Code Assist should be used.
    use_gemini_code_assist: # optional, default is false
    # The version of the Gemini CLI to install.
    gemini_cli_version: # optional, default is latest
          
